package handlers

import (
	"log"

	"github.com/google/go-github/v62/github"
)

func CheckSuiteEventHandler(event *github.Event) error {
	log.Println("CHECK SUITE EVENT:", *event.Action)

	switch *event.Action {
	case "requested", "rerequested":
		log.Println("Creating CheckRun...")
        log.Printf("%s/%s (%s)\n",
            event.GetRepo().GetOwner().GetLogin(),
            event.GetRepo().GetName(),
            event.GetCheckSuite().GetHeadSHA(),
        )
		err := createCheckRun(event, "GOZ Build")
		if err != nil {
			return err
		}
		err = createCheckRun(event, "GOZ Test")
		if err != nil {
			return err
		}
		err = createCheckRun(event, "GOZ PAX'd + Artifactory")
		if err != nil {
			return err
		}

	default:
		log.Println("Unhandled action:", *event.Action)
	}
	return nil
}
